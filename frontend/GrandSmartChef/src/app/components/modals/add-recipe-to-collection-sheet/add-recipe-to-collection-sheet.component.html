<ion-modal
  [isOpen]="isOpen() && !!collectionId()"
  [initialBreakpoint]="0.25"
  [breakpoints]="[0, 0.25, 0.5, 0.75]"
  (didDismiss)="close()">

  <ng-template>
    <ion-content class="ion-padding">

      <ion-row class="search-row ion-align-items-center">
        <ion-col>
          <ion-searchbar
            placeholder="Buscar receta..."
            [value]="searchRecipe()"
            (ionInput)="updateSearch($event)">
          </ion-searchbar>
        </ion-col>

        <ion-col size="auto">
          <ion-button
            class="add-recipe-btn"
            (click)="confirm()"
            [disabled]="selectedRecipes().length === 0">
            AÃ±adir
          </ion-button>
        </ion-col>
      </ion-row>

      <ion-list>
        @for (recipe of filteredRecipes(); track recipe?.id ?? $index) {
          <ion-item
            button
            [disabled]="isAlreadyInCollection(recipe.id)"
            (click)="toggleSelection(recipe.id)"
            [class.selected]="selectedRecipes().includes(recipe.id)"
            [class.already]="isAlreadyInCollection(recipe.id)">

            <ion-avatar slot="start">
              <ion-img [src]="recipe.imageUrl"></ion-img>
            </ion-avatar>

            <ion-label>
              <h2>{{ recipe.name }}</h2>
              <p>
                <ion-icon name="star" color="warning" class="star-card"></ion-icon>
                {{ recipe.averageRating }}
              </p>
            </ion-label>

          </ion-item>
        }
      </ion-list>

    </ion-content>
  </ng-template>

</ion-modal>
