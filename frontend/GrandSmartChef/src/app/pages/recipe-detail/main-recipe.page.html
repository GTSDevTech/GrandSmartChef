<ion-content (ionScroll)="onScroll($event)" [scrollEvents]="true" [fullscreen]="true"
             class="recipe-detail-content" xmlns="http://www.w3.org/1999/html">
  <div class="image-header">
    <ion-img
    class="recipe-image-preview"
    [src]="getRecipeImage(recipe()?.imageUrl)"
    alt="Imagen de la receta"></ion-img>
    <ion-row class="header-buttons">
      <ion-col size="6" class="col-back-button">
        <ion-button fill="clear" class="circle-button" (click)="onClose()">
          <ion-icon size="large" name="arrow-back" slot="icon-only"></ion-icon>
        </ion-button>
      </ion-col>
      <ion-col size="6" class="col-favorite-button">
        <ion-button
          (click)="openFavoriteSelector(recipe()!)"
          fill="clear"
          class="circle-button">
          <ion-icon
            [style.color]="isInFavorites() ? 'var(--primary-orange-color)' : 'white'"
            size="large"
            [name]="isInFavorites() ? 'heart' : 'heart-outline'"
            slot="icon-only">
          </ion-icon>
        </ion-button>
      </ion-col>
    </ion-row>
  </div>
  <ion-row>
    <ion-grid>
      <ion-row class="recipe-title ion-padding-horizontal">
        <h3>{{recipe()?.name}}</h3>
      </ion-row>
      <ion-row class="ion-justify-content-between center-container-column ion-padding-horizontal">

        <ion-col size="auto" class="detail-item">
          <ion-icon name="timer-outline" size="large"></ion-icon><span>{{recipe()?.prepTime}} min.</span>
        </ion-col>
        <ion-col size="auto" class="detail-item">
          <ion-icon name="people-outline" size="large"></ion-icon><span>{{recipe()?.servings}} pers.</span>
        </ion-col>
        <ion-col size="auto" class="detail-item">
          <ion-icon name="speedometer-outline" size="large"></ion-icon><span>{{recipe()?.difficulty}}</span>
        </ion-col>
      </ion-row>
        <ion-row class="tags-row ion-padding">
          @for (tag of recipe()?.tags; track tag.id) {
          <ion-col size="auto">
            <ion-button class="button-tags" shape="round" size="small">{{tag.name}}</ion-button>
          </ion-col>
          }
        </ion-row>
    </ion-grid>
  </ion-row>
  <ion-row class="ion-padding-horizontal">
    <h3>Descripción</h3>
    <ion-text class="ion-text-justify ion-padding">
       {{recipe()?.description}}
    </ion-text>
  </ion-row>
  <ion-row class="ion-padding-start ion-padding-end">
    <ion-grid>
      <ion-row>
        <ion-col class="ion-align-content-end">
          <h3>Ingredientes</h3>
        </ion-col>
        <ion-col>
          <ion-button
            (click)="addToCartList()"
            class="buy-button">
            <ion-icon size= "large" name="cart"></ion-icon>
            Añadir a Compras
          </ion-button>
        </ion-col>
      </ion-row>
    </ion-grid>
  </ion-row>
  <ion-list class="ingredient-list">
    @for (ingr of recipe()?.ingredients; track ingr.ingredient.id){
      <ion-item class="ingredient-item">
        <ion-col size="3" class="ion-text-start">
        <ion-label class="quantity">
          {{ingr.quantity}}
        @if(ingr.unit.length === 1){
            <span>{{ingr.unit}}</span>
          }@else{
            <span class="quantity-span">{{ingr.unit}}</span>
          }
        </ion-label>
        </ion-col>
        <ion-col>
        <ion-label class="name">
          {{ingr.ingredient.name}}
        </ion-label>
        </ion-col>
      </ion-item>
    }
  </ion-list>
  <ion-row class="ion-padding ion-margin-top">
    <h3>Preparación</h3>
  </ion-row>
  <ion-row>
    <ion-list class="ingredient-list">
      @for(step of recipe()?.steps; track $index){
        <ion-item lines="none" class="item-step">
          <ion-col size="2">
            <ion-button class="steps">{{step.stepNumber}}</ion-button>
          </ion-col>
          <ion-col class="name">{{step.instruction}}</ion-col>
        </ion-item>
      }
    </ion-list>
  </ion-row>
  <ion-row class="ion-padding ion-margin-top">
    <h3>Información Nutricional</h3>
  </ion-row>
  <ion-row class="ion-justify-content-center nutrients-row">
        <ion-col class="ion-text-center nutrients">
      <ion-label class="nutrition-values">{{recipe()?.nutritionInfo?.calories}}</ion-label>
      <h5>Calorías</h5>
    </ion-col>
    <ion-col class="ion-text-center nutrients">
      <ion-label class="nutrition-values">{{recipe()?.nutritionInfo?.proteins}}g</ion-label>
      <h5>Proteínas</h5>
    </ion-col>
    <ion-col class="ion-text-center nutrients">
      <ion-label class="nutrition-values">{{recipe()?.nutritionInfo?.carbs}}g</ion-label>
      <h5>Hidratos</h5>
    </ion-col>
    <ion-col class="ion-text-center nutrients">
      <ion-label class="nutrition-values">{{recipe()?.nutritionInfo?.fats}}g</ion-label>
      <h5>Grasas</h5>
    </ion-col>
  </ion-row>
  <ion-row class="ion-justify-content-center ion-padding">
    <ion-button class="score" (click)="openModalRate()"><ion-icon name="star"></ion-icon>¡Puntúa esta receta!</ion-button>
  </ion-row>
  <app-modal-rate
    [recipeId]="recipe()?.id"
    (ratechange)="onRatingSubmitted()">
  </app-modal-rate>

  <app-collection-modal></app-collection-modal>
</ion-content>
<app-footer-nav></app-footer-nav>


